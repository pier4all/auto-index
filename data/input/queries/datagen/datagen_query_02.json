{
  "aggregate":"datagen-02-aggregate-timesheets",
  "pipeline":[
    {
      "$addFields":{
        "price":{
          "$multiply":[
            "$quantity",
            "{$QUANTITY}"
          ]
        }
      }
    },
    {
      "$group":{
        "_id":{
          "project":"$ref-project",
          "year":{
            "$year":"$date"
          },
          "month":{
            "$month":"$date"
          }
        },
        "item":{
          "$push":{
            "ref-timesheet":"$_id",
            "quantity":"$quantity",
            "price":"$price",
            "date":"$date"
          }
        },
        "amount":{
          "$sum":"$price"
        }
      }
    }
  ],
  "collection": "timesheets",
  "allowDiskUse":true,
  "maxTimeMS":0,
  "cursor":{
    
  }
}